{
	"info": {
		"_postman_id": "qr-code-api-production-001",
		"name": "QR Code API - Production Ready Collection",
		"description": "Complete production-ready Postman collection for QR code operations. Supports both User and Business modules.\n\n**SETUP INSTRUCTIONS:**\n1. Set `base_url` environment variable (default: Railway production URL)\n2. **For User Module:** Run 'User Login' to get `userToken`\n3. **For Business Module:** Run 'Business Login' to get `businessToken`\n4. Use helper endpoints to get `orderId`, `reservationId`, `businessId`\n5. Generate QR codes using the IDs\n6. Scan QR codes with appropriate authentication\n\n**IMPORTANT:**\n- User QR operations require `userToken`\n- Business QR operations require `businessToken`\n- Order/Reservation QR requires valid IDs from database\n- Payment/Discount QR uses timestamp (no pre-existing ID needed)",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "0. Setup & Helper Endpoints",
			"item": [
				{
					"name": "Get User Orders (Helper)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    const response = pm.response.json();",
									"    if (response.success && response.data && response.data.orders && response.data.orders.length > 0) {",
									"        const firstOrder = response.data.orders[0];",
									"        pm.environment.set(\"orderId\", firstOrder.id);",
									"        pm.environment.set(\"businessId\", firstOrder.business_id || firstOrder.order_items?.[0]?.business_id || \"\");",
									"        console.log(\"✅ Auto-saved first order ID:\", firstOrder.id);",
									"        console.log(\"✅ Auto-saved business ID:\", firstOrder.business_id || firstOrder.order_items?.[0]?.business_id);",
									"    } else {",
									"        console.log(\"⚠️ No orders found. Create an order first.\");",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{userToken}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/orders/user?limit=10",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"orders",
								"user"
							],
							"query": [
								{
									"key": "limit",
									"value": "10"
								}
							]
						},
						"description": "Get user's orders. Auto-saves first order ID and business ID for QR generation."
					},
					"response": []
				},
				{
					"name": "Get User Reservations (Helper)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    const response = pm.response.json();",
									"    if (response.success && response.data && response.data.reservations && response.data.reservations.length > 0) {",
									"        const firstReservation = response.data.reservations[0];",
									"        pm.environment.set(\"reservationId\", firstReservation.id);",
									"        pm.environment.set(\"businessId\", firstReservation.business_id || \"\");",
									"        console.log(\"✅ Auto-saved first reservation ID:\", firstReservation.id);",
									"        console.log(\"✅ Auto-saved business ID:\", firstReservation.business_id);",
									"    } else {",
									"        console.log(\"⚠️ No reservations found. Create a reservation first.\");",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{userToken}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/reservations/user?limit=10",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"reservations",
								"user"
							],
							"query": [
								{
									"key": "limit",
									"value": "10"
								}
							]
						},
						"description": "Get user's reservations. Auto-saves first reservation ID and business ID for QR generation."
					},
					"response": []
				},
				{
					"name": "Get Business Orders (Helper)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    const response = pm.response.json();",
									"    if (response.success && response.data && response.data.orders && response.data.orders.length > 0) {",
									"        const firstOrder = response.data.orders[0];",
									"        pm.environment.set(\"orderId\", firstOrder.id);",
									"        pm.environment.set(\"businessId\", firstOrder.business_id || \"\");",
									"        console.log(\"✅ Auto-saved first business order ID:\", firstOrder.id);",
									"    } else {",
									"        console.log(\"⚠️ No business orders found.\");",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{businessToken}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/business/orders?limit=10",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"business",
								"orders"
							],
							"query": [
								{
									"key": "limit",
									"value": "10"
								}
							]
						},
						"description": "Get business orders. Auto-saves first order ID for QR generation."
					},
					"response": []
				}
			],
			"description": "Helper endpoints to get orders and reservations for QR code generation"
		},
		{
			"name": "1. Authentication",
			"item": [
				{
					"name": "User Login",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    const response = pm.response.json();",
									"    if (response.success && response.data && response.data.token) {",
									"        pm.environment.set(\"userToken\", response.data.token);",
									"        pm.environment.set(\"userId\", response.data.user?.id || \"\");",
									"        console.log(\"✅ User token saved:\", response.data.token.substring(0, 20) + \"...\");",
									"        console.log(\"✅ User ID:\", response.data.user?.id);",
									"    } else {",
									"        console.log(\"❌ Login failed:\", response.message);",
									"    }",
									"} else {",
									"    console.log(\"❌ Login failed with status:\", pm.response.code);",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"email\": \"user@example.com\",\n    \"password\": \"password123\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/auth/login",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"auth",
								"login"
							]
						},
						"description": "Login as user to get authentication token. **REQUIRED** for all user QR operations. Update email and password with valid credentials."
					},
					"response": []
				},
				{
					"name": "Business Login",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    const response = pm.response.json();",
									"    if (response.success && response.data && response.data.token) {",
									"        pm.environment.set(\"businessToken\", response.data.token);",
									"        pm.environment.set(\"businessId\", response.data.business?.id || \"\");",
									"        console.log(\"✅ Business token saved:\", response.data.token.substring(0, 20) + \"...\");",
									"        console.log(\"✅ Business ID:\", response.data.business?.id);",
									"    } else {",
									"        console.log(\"❌ Business login failed:\", response.message);",
									"    }",
									"} else {",
									"    console.log(\"❌ Business login failed with status:\", pm.response.code);",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"email\": \"owner@business.com\",\n    \"password\": \"business123\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/business/login",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"business",
								"login"
							]
						},
						"description": "Login as business to get authentication token. **REQUIRED** for business QR operations. Update email and password with valid business credentials."
					},
					"response": []
				}
			],
			"description": "Authentication endpoints for User and Business modules"
		},
		{
			"name": "2. Generate QR Codes",
			"item": [
				{
					"name": "Generate Order QR (User)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 201\", function () {",
									"    pm.response.to.have.status(201);",
									"});",
									"",
									"if (pm.response.code === 201) {",
									"    const response = pm.response.json();",
									"    if (response.success && response.data) {",
									"        pm.environment.set(\"orderQrToken\", response.data.qr_token);",
									"        pm.environment.set(\"orderQrId\", response.data.id);",
									"        console.log(\"✅ Order QR Token saved:\", response.data.qr_token);",
									"        console.log(\"✅ QR Type:\", response.data.qr_type);",
									"        console.log(\"✅ Expires At:\", response.data.expires_at);",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{userToken}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"type\": \"order\",\n    \"reference_id\": \"{{orderId}}\",\n    \"additional_data\": {\n        \"business_id\": \"{{businessId}}\"\n    }\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/qr/generate",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"qr",
								"generate"
							]
						},
						"description": "Generate QR code for an order. **REQUIRES:** Valid `orderId` (set via Get User Orders helper). QR expires in 24 hours. Auto-saves `orderQrToken` for scanning."
					},
					"response": []
				},
				{
					"name": "Generate Payment QR",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 201\", function () {",
									"    pm.response.to.have.status(201);",
									"});",
									"",
									"if (pm.response.code === 201) {",
									"    const response = pm.response.json();",
									"    if (response.success && response.data) {",
									"        pm.environment.set(\"paymentQrToken\", response.data.qr_token);",
									"        console.log(\"✅ Payment QR Token saved:\", response.data.qr_token);",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{userToken}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"type\": \"payment\",\n    \"reference_id\": \"payment-{{$timestamp}}\",\n    \"additional_data\": {\n        \"business_id\": \"{{businessId}}\",\n        \"amount\": 5000\n    }\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/qr/generate",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"qr",
								"generate"
							]
						},
						"description": "Generate QR code for payment. **NOTE:** Uses timestamp (no pre-existing ID needed). QR expires in 1 hour. One-time use only. Auto-saves `paymentQrToken`."
					},
					"response": []
				},
				{
					"name": "Generate Reservation QR",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 201\", function () {",
									"    pm.response.to.have.status(201);",
									"});",
									"",
									"if (pm.response.code === 201) {",
									"    const response = pm.response.json();",
									"    if (response.success && response.data) {",
									"        pm.environment.set(\"reservationQrToken\", response.data.qr_token);",
									"        console.log(\"✅ Reservation QR Token saved:\", response.data.qr_token);",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{userToken}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"type\": \"reservation\",\n    \"reference_id\": \"{{reservationId}}\",\n    \"additional_data\": {\n        \"business_id\": \"{{businessId}}\"\n    }\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/qr/generate",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"qr",
								"generate"
							]
						},
						"description": "Generate QR code for a reservation. **REQUIRES:** Valid `reservationId` (set via Get User Reservations helper). QR expires in 24 hours. Auto-saves `reservationQrToken`."
					},
					"response": []
				},
				{
					"name": "Generate Discount QR",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 201\", function () {",
									"    pm.response.to.have.status(201);",
									"});",
									"",
									"if (pm.response.code === 201) {",
									"    const response = pm.response.json();",
									"    if (response.success && response.data) {",
									"        pm.environment.set(\"discountQrToken\", response.data.qr_token);",
									"        console.log(\"✅ Discount QR Token saved:\", response.data.qr_token);",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{userToken}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"type\": \"discount\",\n    \"reference_id\": \"discount-{{$timestamp}}\",\n    \"additional_data\": {\n        \"business_id\": \"{{businessId}}\",\n        \"discount_percentage\": 10\n    }\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/qr/generate",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"qr",
								"generate"
							]
						},
						"description": "Generate QR code for discount/coupon. **NOTE:** Uses timestamp (no pre-existing ID needed). QR expires in 24 hours. One-time use only. Auto-saves `discountQrToken`."
					},
					"response": []
				},
				{
					"name": "Generate Driver Pickup QR",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 201\", function () {",
									"    pm.response.to.have.status(201);",
									"});",
									"",
									"if (pm.response.code === 201) {",
									"    const response = pm.response.json();",
									"    if (response.success && response.data) {",
									"        pm.environment.set(\"driverPickupQrToken\", response.data.qr_token);",
									"        console.log(\"✅ Driver Pickup QR Token saved:\", response.data.qr_token);",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{userToken}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"type\": \"driver_pickup\",\n    \"reference_id\": \"{{orderId}}\",\n    \"additional_data\": {\n        \"driver_id\": \"{{driverId}}\",\n        \"business_id\": \"{{businessId}}\"\n    }\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/qr/generate",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"qr",
								"generate"
							]
						},
						"description": "Generate QR code for driver pickup. **REQUIRES:** Valid `orderId` and `driverId`. QR expires in 2 hours. Used by drivers to confirm order pickup. Auto-saves `driverPickupQrToken`."
					},
					"response": []
				}
			],
			"description": "Generate QR codes for all types (Order, Payment, Reservation, Discount, Driver Pickup)"
		},
		{
			"name": "3. Validate QR Code",
			"item": [
				{
					"name": "Validate QR Code",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"if (pm.response.code === 200) {",
									"    const response = pm.response.json();",
									"    if (response.success) {",
									"        console.log(\"✅ QR Code is valid\");",
									"        console.log(\"QR Type:\", response.data.qr_type);",
									"        console.log(\"Expires At:\", response.data.expires_at);",
									"        console.log(\"Reference ID:\", response.data.reference_id);",
									"    } else {",
									"        console.log(\"❌ QR Code validation failed:\", response.message);",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{userToken}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"qr_token\": \"{{orderQrToken}}\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/qr/validate",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"qr",
								"validate"
							]
						},
						"description": "Validate if a QR code token is valid and not expired. Use this before scanning to check QR status. Works with any QR token (orderQrToken, paymentQrToken, etc.)."
					},
					"response": []
				}
			],
			"description": "Validate QR code before scanning"
		},
		{
			"name": "4. Scan QR Code (User Module)",
			"item": [
				{
					"name": "Scan Order QR (User)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"if (pm.response.code === 200) {",
									"    const response = pm.response.json();",
									"    if (response.success) {",
									"        console.log(\"✅ Order QR scanned successfully\");",
									"        console.log(\"Message:\", response.message);",
									"        console.log(\"Order Status:\", response.data?.status);",
									"    } else {",
									"        console.log(\"❌ Scan failed:\", response.message);",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{userToken}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"qr_token\": \"{{orderQrToken}}\",\n    \"action\": \"process\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/qr/scan",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"qr",
								"scan"
							]
						},
						"description": "Scan and process an order QR code as a user. Updates order status. **REQUIRES:** Valid `userToken` and `orderQrToken`."
					},
					"response": []
				},
				{
					"name": "Scan Payment QR (User)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"if (pm.response.code === 200) {",
									"    const response = pm.response.json();",
									"    if (response.success) {",
									"        console.log(\"✅ Payment QR processed:\", response.message);",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{userToken}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"qr_token\": \"{{paymentQrToken}}\",\n    \"action\": \"process\",\n    \"additional_data\": {\n        \"amount\": 5000\n    }\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/qr/scan",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"qr",
								"scan"
							]
						},
						"description": "Scan and process a payment QR code. Processes payment and marks QR as used (one-time use). **REQUIRES:** Valid `userToken` and `paymentQrToken`."
					},
					"response": []
				},
				{
					"name": "Scan Reservation QR (User)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"if (pm.response.code === 200) {",
									"    const response = pm.response.json();",
									"    if (response.success) {",
									"        console.log(\"✅ Reservation validated:\", response.message);",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{userToken}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"qr_token\": \"{{reservationQrToken}}\",\n    \"action\": \"process\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/qr/scan",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"qr",
								"scan"
							]
						},
						"description": "Scan and process a reservation QR code. Validates reservation and updates status to completed. **REQUIRES:** Valid `userToken` and `reservationQrToken`."
					},
					"response": []
				},
				{
					"name": "Scan Discount QR (User)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"if (pm.response.code === 200) {",
									"    const response = pm.response.json();",
									"    if (response.success) {",
									"        console.log(\"✅ Discount applied:\", response.message);",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{userToken}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"qr_token\": \"{{discountQrToken}}\",\n    \"action\": \"redeem\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/qr/scan",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"qr",
								"scan"
							]
						},
						"description": "Scan and process a discount QR code. Applies discount and marks QR as used (one-time use). **REQUIRES:** Valid `userToken` and `discountQrToken`."
					},
					"response": []
				},
				{
					"name": "Scan Driver Pickup QR (User)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"if (pm.response.code === 200) {",
									"    const response = pm.response.json();",
									"    if (response.success) {",
									"        console.log(\"✅ Pickup confirmed:\", response.message);",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{userToken}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"qr_token\": \"{{driverPickupQrToken}}\",\n    \"action\": \"confirm_pickup\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/qr/scan",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"qr",
								"scan"
							]
						},
						"description": "Scan and process a driver pickup QR code. **NOTE:** This should be used by drivers, not users. Confirms order pickup and updates order status. **REQUIRES:** Valid `userToken` (driver token) and `driverPickupQrToken`."
					},
					"response": []
				}
			],
			"description": "Scan QR codes as a user. All endpoints require valid `userToken`."
		},
		{
			"name": "5. Scan QR Code (Business Module)",
			"item": [
				{
					"name": "Scan Order QR (Business)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"if (pm.response.code === 200) {",
									"    const response = pm.response.json();",
									"    if (response.success) {",
									"        console.log(\"✅ Order QR scanned by business:\", response.message);",
									"        console.log(\"Order Status:\", response.data?.status);",
									"    } else {",
									"        console.log(\"❌ Scan failed:\", response.message);",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{businessToken}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"qr_token\": \"{{orderQrToken}}\",\n    \"action\": \"process\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/qr/scan",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"qr",
								"scan"
							]
						},
						"description": "Scan and process an order QR code as a business. **NOTE:** QR routes currently use `authenticate` middleware which may not work for businesses. If you get 'User not found or inactive', the QR routes may need to support business authentication. **REQUIRES:** Valid `businessToken` and `orderQrToken`."
					},
					"response": []
				},
				{
					"name": "Scan Payment QR (Business)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"if (pm.response.code === 200) {",
									"    const response = pm.response.json();",
									"    if (response.success) {",
									"        console.log(\"✅ Payment QR processed by business:\", response.message);",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{businessToken}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"qr_token\": \"{{paymentQrToken}}\",\n    \"action\": \"process\",\n    \"additional_data\": {\n        \"amount\": 5000\n    }\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/qr/scan",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"qr",
								"scan"
							]
						},
						"description": "Scan and process a payment QR code as a business. **NOTE:** QR routes may need business authentication support. **REQUIRES:** Valid `businessToken` and `paymentQrToken`."
					},
					"response": []
				},
				{
					"name": "Scan Reservation QR (Business)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"if (pm.response.code === 200) {",
									"    const response = pm.response.json();",
									"    if (response.success) {",
									"        console.log(\"✅ Reservation validated by business:\", response.message);",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{businessToken}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"qr_token\": \"{{reservationQrToken}}\",\n    \"action\": \"process\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/qr/scan",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"qr",
								"scan"
							]
						},
						"description": "Scan and process a reservation QR code as a business. Validates reservation and updates status. **REQUIRES:** Valid `businessToken` and `reservationQrToken`."
					},
					"response": []
				}
			],
			"description": "Scan QR codes as a business. **IMPORTANT:** QR routes currently use `authenticate` middleware which may not support business authentication. If you encounter 'User not found or inactive', the backend may need to be updated to support business authentication for QR scanning."
		}
	],
	"variable": [
		{
			"key": "base_url",
			"value": "https://csy-backend-production.up.railway.app",
			"type": "string"
		},
		{
			"key": "userToken",
			"value": "",
			"type": "string",
			"description": "User authentication token - Set via User Login"
		},
		{
			"key": "businessToken",
			"value": "",
			"type": "string",
			"description": "Business authentication token - Set via Business Login"
		},
		{
			"key": "userId",
			"value": "",
			"type": "string"
		},
		{
			"key": "businessId",
			"value": "",
			"type": "string",
			"description": "Business ID - Auto-saved from helper endpoints"
		},
		{
			"key": "orderId",
			"value": "",
			"type": "string",
			"description": "Order ID - Auto-saved from Get User Orders helper"
		},
		{
			"key": "reservationId",
			"value": "",
			"type": "string",
			"description": "Reservation ID - Auto-saved from Get User Reservations helper"
		},
		{
			"key": "driverId",
			"value": "",
			"type": "string",
			"description": "Driver ID - Set manually if needed for driver pickup QR"
		},
		{
			"key": "orderQrToken",
			"value": "",
			"type": "string",
			"description": "Order QR token - Auto-saved from Generate Order QR"
		},
		{
			"key": "paymentQrToken",
			"value": "",
			"type": "string",
			"description": "Payment QR token - Auto-saved from Generate Payment QR"
		},
		{
			"key": "reservationQrToken",
			"value": "",
			"type": "string",
			"description": "Reservation QR token - Auto-saved from Generate Reservation QR"
		},
		{
			"key": "discountQrToken",
			"value": "",
			"type": "string",
			"description": "Discount QR token - Auto-saved from Generate Discount QR"
		},
		{
			"key": "driverPickupQrToken",
			"value": "",
			"type": "string",
			"description": "Driver Pickup QR token - Auto-saved from Generate Driver Pickup QR"
		},
		{
			"key": "orderQrId",
			"value": "",
			"type": "string"
		}
	]
}
